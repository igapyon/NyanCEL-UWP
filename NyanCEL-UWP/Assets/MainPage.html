<html>
<head>
</head>
<body>
 
<h1>NyanCEL-UWP</h1>
<p>NyanCEL は Excel ブック (.xlsx) を SQL で検索できるようにするサーバーツールです。</p>

<ul>
    <li>- NyanCELは、NyanQLのコンセプトを基に、Excelブック検索機能に特化しています。</li>
    <li>- UWP + C#で実装されており、Microsoft Store で配布する計画です。</li>
    <li>- MITライセンスのもとで公開されています。</li>    
</ul>

<h2>Usage</h2>

<ol>
    <li>Excelブック（.xlsx）ファイルを指定します。<br/>
        - シート名をテーブル名として使用します。<br/>
        - 1行目のセル値を項目名として使用します。<br/>
        - 2行目のセル書式から項目データ型を導出します。<br/>
    </li>  
    <li>指定したExcelブックの内容をSQLiteデータベースに読み込みます。<br/>
        - データはメモリ上のSQLiteにロードされます。
    </li>
    <li>RESTインターフェースからSELECT文を実行します。<br/>
        - アルファ版のしばらくの間は ベーシック認証のユーザーは <b>nyan</b>、パスワードは <b>cel</b> です。<br/>
        - SQLiteのSQL文法が利用可能です。<br/>
        - GETおよびPOSTメソッドが利用可能です。(現状はGETのみ対応)<br/>
        - (デフォルトの) ポート番号は28096です。<br/>
    <li>データベースの検索結果をJSONで返却します。<br/>
        - 行データを繰り返して返却します。<br/>
    </li>
</ol>

<h3>Example</h3>

<p>
    以下のように Web ブラウザで URL を指定することにより SQL文を実行させることができます。
</p>
<code>
    http://IPADDRESS:28096/api?sql=SELECT%20*%20FROM%20sqlite_master
</code>

<h2>Running information</h2>

<ul>
    <li>REST server port : 28096</li>
    <li>Version : ver 20240612a</li>
    <li>License : MIT LICENSE</li>
    <li>This application is released under MIT license.</li>
</ul>

<h2>制限</h2>

<ul>
    <li>- オンメモリRDBMSで動作するため、大量のデータを与えた場合に動作しない可能性があります。</li>
    <li>- .xlsx ファイルにのみ対応します。</li>
    <li>- UWPアプリの一般的な制約により、ループバックによるHTTP接続 (localhost指定) ができません。別のマシンからアクセスしてください。</li>
</ul>

<h2>工事中</h2>

<a href="#" id="link1">ここにアプリ終了ボタンを配置予定</a>

<script>
    document.getElementById("link1");
    addEventListener("click", function (event){
        event.preventDefault();
        window.chrome.webview.postMessage("link1 clicked");
    });
</script>
</body>
</html>